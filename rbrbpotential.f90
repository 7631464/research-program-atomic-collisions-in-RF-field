! ********************************************************************C
!                                                                     C
!                     Rb2  TRIPLET SIGMA U +                          C
!                                                                     C
!  TWICE THE REDUCED MASS (TWOMU) = 86.90927 * 1822.88732             C
!  FUNCTION IS CALLED ONCE WITH R=0.D0 TO GET SPLINE COEFFS BEFORE    C
!   MAIN RUN.  ONE R PER CALL.                                        C
!                                                                     C
!  POTENTIAL IS FROM KRAUSS & STEVENS J CHEM PHYS 93, 4236 (1990)     C
!  LONG-RANGE COEFFICEINTS FROM MARINESCU ET AL                       C
!        PHYS REV A 49, 982 (1994).                                   C
!                                                                     C
! ********************************************************************C
Real*8 FUNCTION vatsup_unret(R,c1coef,csix)
Implicit double precision (a-h,o-z)
Integer ncn,nret
PARAMETER (NCN=16,nret=29)
Real*8 amp,twomu,HARTREE,BOHR,det,CEIGHT,CTEN,ALPHA,BETA,RAT(ncn),PRT(ncn), Y2_t(NCN), UU(NCN), ret(nret),tf6(nret),tf8(nret),tf10(nret), d2tf6(nret),d2tf8(nret),d2tf10(nret),r,z,c,csix,tail,vcalc,slope,yp1,ypn,x1,s,bs_t,as_t,pots,rmin,c1coef



PARAMETER (TWOMU=1.D0)
PARAMETER (HARTREE=219474.64D0, BOHR=0.529177249D0)
PARAMETER (DET=333.0D0)
!  long range parameters are discussed above
PARAMETER (CEIGHT=550600.D0,CTEN=76650000.D0)
!  4426, 550600
PARAMETER (AMP=3.76473023d-3,ALPHA=5.316837D0,BETA=1.108149D0)

! THESE ARE IN A.U.

DATA PRT  / 0.013797D0,   0.008802D0,   0.005272D0,&
0.002877D0,   0.001299D0,   0.000291D0,&
-0.000327D0,   -0.000862D0,   -0.000927D0,&
-0.000918D0,   -0.000866D0,   -0.000790D0,&
-0.000334D0,   -0.000174D0, -0.000093D0,&
0.0d0 /

DATA RAT /  7.00D0, 7.50D0, 8.00D0,&
8.50D0, 9.00D0, 9.50D0,&
10.00D0, 11.00D0, 11.50D0,&
12.00D0, 12.50D0,  13.00D0,&
16.00D0, 18.00D0 ,20.00d0, 22.0d0/

Data ret / 10.0d0,15.0d0,20.0d0,25.0d0,30.0d0,50.0d0,&
70.0d0,100.0d0,150.0d0,200.0d0,250.0d0,&
300.0d0,500.0d0,700.0d0,1000.0d0,1500.0d0,&
2000.0d0,2500.0d0,3000.0d0,5000.0d0,7000.0d0,&
10000.0d0,15000.0d0,20000.0d0,25000.0d0,&
30000.0d0,50000.0d0,70000.0d0,100000.0d0 /

Data tf6 / 0.999994d0, 0.999987d0, 0.999977d0, 0.999965d0,&
0.999949d0, 0.999860d0, 0.999728d0, 0.999454d0,&
0.998802d0, 0.997923d0, 0.996833d0, 0.995549d0,&
0.988729d0, 0.979729d0, 0.963284d0, 0.930931d0,&
0.895430d0, 0.858909d0, 0.822614d0,&
0.690307d0, 0.584398d0, 0.467502d0, 0.344177d0,&
0.269625d0, 0.220627d0, 0.186276d0, 0.114045d0,&
0.0819356d0, 0.0575372d0  /

Data tf8 / 0.999996d0, 0.999991d0, 0.999985d0, 0.999976d0,&
0.999966d0, 0.999906d0, 0.999818d0, 0.999633d0,&
0.999190d0, 0.998588d0, 0.997835d0, 0.996940d0,&
0.992092d0, 0.985527d0, 0.973187d0, 0.947975d0,&
0.919218d0, 0.888653d0, 0.857413d0, 0.737266d0,&
0.634940d0, 0.516475d0, 0.385941d0, 0.304609d0,&
0.250295d0, 0.211860d0, 0.130245d0, 0.0936901d0,&
0.0658322d0   /

Data tf10 / 0.999997d0, 0.999993d0, 0.999987d0, 0.999980d0,&
0.999972d0, 0.999922d0, 0.999847d0, 0.999692d0,&
0.999319d0, 0.998809d0, 0.998171d0, 0.997410d0,&
0.993256d0, 0.987574d0, 0.976775d0, 0.954373d0,&
0.928411d0, 0.900439d0, 0.871505d0, 0.757578d0,&
0.657798d0, 0.539634d0, 0.406564d0, 0.322302d0,&
0.265515d0, 0.225106d0, 0.138767d0, 0.0999073d0,&
0.072340d0  /

SAVE

! CONSTRUCTION OF THE POTENTIAL
! --- The section below is the initial setup.

IF (R.EQ.0.D0) THEN

Z = rat(ncn)

C = CSIX/Z**6 + CEIGHT/Z**8 + CTEN/Z**10
TAIL = AMP*(Z**ALPHA)*EXP(-BETA*Z)
VCALC = - C + TAIL
prt(ncn) = vcalc

SLOPE = (6*CSIX/(Z**7)) + (8*CEIGHT/(Z**9)) &
+ (10*CTEN/(Z**11))&
+ (ALPHA/Z - BETA)*AMP*(Z**ALPHA)*EXP(-BETA*Z)
YP1=1.D40
YPN=SLOPE
CALL Cubic_SPLINE(RAT,PRT,NCN,YP1,YPN,Y2_T)
x1 = RAT(1)
CALL Cubic_SPLINT(RAT,PRT,Y2_T,NCN,x1,S,1)
BS_T = -S/PRT(1)
AS_T = PRT(1)*DEXP(BS_T*RaT(1))

! THE NEXT THREE BRANCHES GIVE THE POTENTIAL DEPENDING ON R

ELSE IF ((R.GT.0.D0).AND.(R.LT.RAT(1))) THEN
!write(*,*) "code mark","r=",R,"bs_t=",bs_t,"as_t=",as_t,"TWOMU",TWOMU,"vat=",TWOMU*AS_T*DEXP(-BS_T*R)
vatsup_unret = TWOMU*AS_T*DEXP(-BS_T*R)
ELSE IF ((R.GE.RAT(1)).AND.(R.LE.RAT(NCN))) THEN
CALL Cubic_SPLINT(RAT,PRT,Y2_T,NCN,R,POTS,0)
vatsup_unret = TWOMU*POTS
ELSE
C = CSIX/R**6 + CEIGHT/R**8 + CTEN/R**10
TAIL = AMP*(R**ALPHA)*DEXP(-BETA*R)
vatsup_unret = - C + TAIL
END IF
!  here's something to patch up the scattering length (see Mies et al) --JB

rmin = 11.6630d0
IF(R .LE. rmin) THEN
vatsup_unret = vatsup_unret+ C1COEF*datan((r-rmin)*(r-rmin)/4.0d0)
END IF
return

END FUNCTION vatsup_unret

! ********************************************************************C
!                                                                     C
!                     Rb2  SINGLET SIGMA G + : ISOTOPE 87             C
!                                                                     C
!  TWICE THE REDUCED MASS (TWOMU) = 86.90927 * 1822.88732             C
!     (THIS IS JUST THE MASS OF THE ISOTOPE)                          C
!  FUNCTION IS CALLED ONCE WITH R=0.D0 TO GET SPLINE COEFFS BEFORE    C
!   MAIN RUN.  ONE R PER CALL.                                        C
!                                                                     C
! ********************************************************************C
Real*8 FUNCTION vxssgp_unret(R,c0coef,csix)
implicit double precision (a-h,o-z)
Integer ncn,nret, kindd,i
PARAMETER (NCN=205,nret=29)
Real*8 TWOMu,de,HARTREE,BOHR,DES,CEIGHT,CTEN,AMP,ALPHA,BETA,RRS(NCN),PS(NCN), RAS(ncn),PRS(ncn), Y2_p(NCN), UU(NCN),R,c0coef, ret(nret),sf6(nret),sf8(nret),sf10(nret), d2sf6(nret),d2sf8(nret),d2sf10(nret),u,c,csix,tail,vcalc,slope,yp1,ypn,x1,s,cs,bs,as,rmin,pots

PARAMETER (TWOMU=1.0D0,de=3993.53d0)
PARAMETER (HARTREE=219474.64D0, BOHR=0.529177249D0)
PARAMETER (DES=8516.61D0)
!  C8,C8,C10 from Marinescu et al, Phys. Rev. A 49, 982 (1994) --JB
PARAMETER (CEIGHT=550600.D0,CTEN=76650000.D0)
!  4426  4550
!  long-range exchange from Smirnov & Chibisov, JETP 21, 624 (1965),
!  using ionization potential from the CRC, and matching to
!  the difference V_trip - V_sing at R=20 au
PARAMETER (AMP=3.76473023d-3,ALPHA=5.316837D0,BETA=1.108149D0)


! FROM KRAUSS AND STEVENS
! THE potential is in spectroscopic units (cm^-1), R is in a.u.

DATA PRS  / &
!     & 0.39782243E+04, 0.39742893E+04, 0.39697400E+04,
!     & 0.39645295E+04, 0.39586213E+04, 0.39519863E+04,
!     & 0.39446020E+04, 0.39364512E+04, 0.39275123E+04,
!     & 0.39178037E+04, 0.39072932E+04, 0.38959871E+04,
!     & 0.38838852E+04, 0.38709894E+04, 0.38573032E+04,
!     & 0.38428315E+04, 0.38275804E+04, 0.38115569E+04,&
0.37947688E+04, 0.37772247E+04, 0.37589336E+04,&
0.37399048E+04, 0.37201481E+04, 0.36996733E+04,&
0.36784906E+04, 0.36566102E+04, 0.36340421E+04,&
0.36107965E+04, 0.35868837E+04, 0.35623136E+04,&
0.35370962E+04, 0.35112414E+04, 0.34847589E+04,&
0.34576582E+04, 0.34299488E+04, 0.34016398E+04,&
0.33727405E+04, 0.33432596E+04, 0.33132059E+04,&
0.32825880E+04, 0.32514143E+04, 0.32196929E+04,&
0.31874320E+04, 0.31546393E+04, 0.31213227E+04,&
0.30874895E+04, 0.30531471E+04, 0.30183028E+04,&
0.29829636E+04, 0.29471363E+04, 0.29108276E+04,&
0.28740442E+04, 0.28367923E+04, 0.27990782E+04,&
0.27609080E+04, 0.27222877E+04, 0.26832230E+04,&
0.26437197E+04, 0.26037831E+04, 0.25634188E+04,&
0.25226319E+04, 0.24814276E+04, 0.24398109E+04,&
0.23977865E+04, 0.23553594E+04, 0.23125340E+04,&
0.22693149E+04, 0.22257065E+04, 0.21817131E+04,&
0.21373388E+04, 0.20925877E+04, 0.20474638E+04,&
0.20019709E+04, 0.19561127E+04, 0.19098929E+04,&
0.18633151E+04, 0.18163827E+04, 0.17690992E+04,&
0.17214676E+04, 0.16734913E+04, 0.16251733E+04,&
0.15765165E+04, 0.15275240E+04, 0.14781985E+04,&
0.14285428E+04, 0.13785594E+04, 0.13282510E+04,&
0.12776200E+04, 0.12266689E+04, 0.11754000E+04,&
0.11238155E+04, 0.10719175E+04, 0.10197084E+04,&
0.96719000E+03, 0.91436430E+03, 0.86123340E+03,&
0.80779910E+03, 0.75406310E+03, 0.70002740E+03,&
0.64569370E+03, 0.59106360E+03, 0.53613900E+03,&
0.48092150E+03, 0.42541270E+03, 0.36961430E+03,&
0.31352810E+03, 0.25715580E+03, 0.20049890E+03,&
0.14355940E+03, 0.86339000E+02, 0.28839600E+02,&
0.28839600E+02, 0.86339000E+02, 0.14355940E+03,&
0.20049890E+03, 0.25715580E+03, 0.31352810E+03,&
0.36961430E+03, 0.42541270E+03, 0.48092150E+03,&
0.53613900E+03, 0.59106360E+03, 0.64569370E+03,&
0.70002740E+03, 0.75406310E+03, 0.80779910E+03,&
0.86123340E+03, 0.91436430E+03, 0.96719000E+03,&
0.10197084E+04, 0.10719175E+04, 0.11238155E+04,&
0.11754000E+04, 0.12266689E+04, 0.12776200E+04,&
0.13282510E+04, 0.13785594E+04, 0.14285428E+04,&
0.14781985E+04, 0.15275240E+04, 0.15765165E+04,&
0.16251733E+04, 0.16734913E+04, 0.17214676E+04,&
0.17690992E+04, 0.18163827E+04, 0.18633151E+04,&
0.19098929E+04, 0.19561127E+04, 0.20019709E+04,&
0.20474638E+04, 0.20925877E+04, 0.21373388E+04,&
0.21817131E+04, 0.22257065E+04, 0.22693149E+04,&
0.23125340E+04, 0.23553594E+04, 0.23977865E+04,&
0.24398109E+04, 0.24814276E+04, 0.25226319E+04,&
0.25634188E+04, 0.26037831E+04, 0.26437197E+04,&
0.26832230E+04, 0.27222877E+04, 0.27609080E+04,&
0.27990782E+04, 0.28367923E+04, 0.28740442E+04,&
0.29108276E+04, 0.29471363E+04, 0.29829636E+04,&
0.30183028E+04, 0.30531471E+04, 0.30874895E+04,&
0.31213227E+04, 0.31546393E+04, 0.31874320E+04,&
0.32196929E+04, 0.32514143E+04, 0.32825880E+04,&
0.33132059E+04, 0.33432596E+04, 0.33727405E+04,&
0.34016398E+04, 0.34299488E+04, 0.34576582E+04,&
0.34847589E+04, 0.35112414E+04, 0.35370962E+04,&
0.35623136E+04, 0.35868837E+04, 0.36107965E+04,&
0.36340421E+04, 0.36566102E+04, 0.36784906E+04,&
0.36996733E+04, 0.37201481E+04, 0.37399048E+04,&
0.37589336E+04, 0.37772247E+04, 0.37947688E+04,&
0.38115569E+04, 0.38275804E+04, 0.38428315E+04,&
0.38573032E+04, 0.38709894E+04, 0.38838852E+04,&
0.38959871E+04, 0.39072932E+04, 0.39178037E+04,&
0.39275123E+04, 0.39364512E+04, 0.39446020E+04,&
0.39519863E+04, 0.39586213E+04, 0.39645295E+04,&
0.39697400E+04, 0.39742893E+04, 0.39782243E+04,&
0.0d0 /


DATA RAS / &
!     & 0.59072634E+01, 0.59081493E+01, 0.59094727E+01,
!     & 0.59111151E+01, 0.59129894E+01, 0.59148588E+01,
!     & 0.59167719E+01, 0.59187403E+01, 0.59206921E+01,
!     & 0.59227708E+01, 0.59250385E+01, 0.59273061E+01,
!     & 0.59297628E+01, 0.59324084E+01, 0.59350540E+01,
!     & 0.59378886E+01, 0.59411011E+01, 0.59443136E+01,&
0.59477151E+01, 0.59513056E+01, 0.59550851E+01,&
0.59590535E+01, 0.59632109E+01, 0.59673683E+01,&
0.59719036E+01, 0.59766279E+01, 0.59815412E+01,&
0.59866434E+01, 0.59919347E+01, 0.59974149E+01,&
0.60028951E+01, 0.60087532E+01, 0.60148003E+01,&
0.60208474E+01, 0.60272725E+01, 0.60336975E+01,&
0.60405005E+01, 0.60473036E+01, 0.60544845E+01,&
0.60616655E+01, 0.60690354E+01, 0.60765943E+01,&
0.60845311E+01, 0.60924679E+01, 0.61005938E+01,&
0.61089085E+01, 0.61174123E+01, 0.61261050E+01,&
0.61349867E+01, 0.61440574E+01, 0.61533170E+01,&
0.61629546E+01, 0.61725922E+01, 0.61824188E+01,&
0.61926233E+01, 0.62028278E+01, 0.62134102E+01,&
0.62241817E+01, 0.62351421E+01, 0.62464804E+01,&
0.62578187E+01, 0.62695350E+01, 0.62816292E+01,&
0.62937235E+01, 0.63061956E+01, 0.63190458E+01,&
0.63320849E+01, 0.63453129E+01, 0.63589189E+01,&
0.63729029E+01, 0.63870758E+01, 0.64016267E+01,&
0.64165555E+01, 0.64316733E+01, 0.64471690E+01,&
0.64632317E+01, 0.64794833E+01, 0.64961128E+01,&
0.65133093E+01, 0.65308837E+01, 0.65488361E+01,&
0.65673554E+01, 0.65862526E+01, 0.66057168E+01,&
0.66257479E+01, 0.66461569E+01, 0.66673218E+01,&
0.66892426E+01, 0.67115413E+01, 0.67347849E+01,&
0.67587844E+01, 0.67835398E+01, 0.68090510E+01,&
0.68356961E+01, 0.68634750E+01, 0.68921988E+01,&
0.69222454E+01, 0.69536149E+01, 0.69864960E+01,&
0.70210780E+01, 0.70577386E+01, 0.70966669E+01,&
0.71382408E+01, 0.71828383E+01, 0.72310262E+01,&
0.72841275E+01, 0.73432758E+01, 0.74105499E+01,&
0.74899183E+01, 0.75900737E+01, 0.77404956E+01,&
0.81840137E+01, 0.83599469E+01, 0.84858025E+01,&
0.85910601E+01, 0.86847904E+01, 0.87703948E+01,&
0.88501412E+01, 0.89257301E+01, 0.89975396E+01,&
0.90667035E+01, 0.91335997E+01, 0.91984172E+01,&
0.92615339E+01, 0.93231389E+01, 0.93836101E+01,&
0.94429474E+01, 0.95013398E+01, 0.95587874E+01,&
0.96156681E+01, 0.96717929E+01, 0.97273507E+01,&
0.97825306E+01, 0.98371436E+01, 0.98913787E+01,&
0.99454248E+01, 0.99990929E+01, 0.10052572E+02,&
0.10105862E+02, 0.10159152E+02, 0.10212254E+02,&
0.10265166E+02, 0.10318078E+02, 0.10371179E+02,&
0.10424092E+02, 0.10477193E+02, 0.10530294E+02,&
0.10583584E+02, 0.10637064E+02, 0.10690732E+02,&
0.10744400E+02, 0.10798446E+02, 0.10852870E+02,&
0.10907483E+02, 0.10962285E+02, 0.11017654E+02,&
0.11073212E+02, 0.11129336E+02, 0.11185839E+02,&
0.11242720E+02, 0.11300167E+02, 0.11358182E+02,&
0.11416763E+02, 0.11475534E+02, 0.11535627E+02,&
0.11596098E+02, 0.11657325E+02, 0.11719308E+02,&
0.11781858E+02, 0.11845542E+02, 0.11909792E+02,&
0.11975177E+02, 0.12041506E+02, 0.12108969E+02,&
0.12177377E+02, 0.12246919E+02, 0.12317783E+02,&
0.12389971E+02, 0.12463481E+02, 0.12538314E+02,&
0.12614848E+02, 0.12691004E+02, 0.12772640E+02,&
0.12854276E+02, 0.12937802E+02, 0.13023406E+02,&
0.13111089E+02, 0.13201040E+02, 0.13293637E+02,&
0.13388690E+02, 0.13486577E+02, 0.13587489E+02,&
0.13691612E+02, 0.13799138E+02, 0.13910442E+02,&
0.14025715E+02, 0.14145146E+02, 0.14269301E+02,&
0.14398369E+02, 0.14532917E+02, 0.14673324E+02,&
0.14820155E+02, 0.14974167E+02, 0.15135739E+02,&
0.15305814E+02, 0.15485149E+02, 0.15674688E+02,&
0.15875754E+02, 0.16089671E+02, 0.16317761E+02,&
0.16561724E+02, 0.16824018E+02, 0.17106720E+02,&
0.17412666E+02, 0.17745636E+02, 0.18109218E+02,&
0.18508706E+02, 0.18949578E+02, 0.19438828E+02,&
0.19984202E+02, 0.20594394E+02, 0.21279040E+02,&
0.22000000e+02 /


Data ret / 10.0d0,15.0d0,20.0d0,25.0d0,30.0d0,50.0d0,&
70.0d0,100.0d0,150.0d0,200.0d0,250.0d0,&
300.0d0,500.0d0,700.0d0,1000.0d0,1500.0d0,&
2000.0d0,2500.0d0,3000.0d0,5000.0d0,7000.0d0,&
10000.0d0,15000.0d0,20000.0d0,25000.0d0,&
30000.0d0,50000.0d0,70000.0d0,100000.0d0 /

Data sf6 / 0.999994d0, 0.999987d0, 0.999977d0, 0.999965d0,&
0.999949d0, 0.999860d0, 0.999728d0, 0.999454d0,&
0.998802d0, 0.997923d0, 0.996833d0, 0.995549d0,&
0.988729d0, 0.979729d0, 0.963284d0, 0.930931d0,&
0.895430d0, 0.858909d0, 0.822614d0,&
0.690307d0, 0.584398d0, 0.467502d0, 0.344177d0,&
0.269625d0, 0.220627d0, 0.186276d0, 0.114045d0,&
0.0819356d0, 0.0575372d0  /

Data sf8 / 0.999996d0, 0.999991d0, 0.999985d0, 0.999976d0,&
0.999966d0, 0.999906d0, 0.999818d0, 0.999633d0,&
0.999190d0, 0.998588d0, 0.997835d0, 0.996940d0,&
0.992092d0, 0.985527d0, 0.973187d0, 0.947975d0,&
0.919218d0, 0.888653d0, 0.857413d0, 0.737266d0,&
0.634940d0, 0.516475d0, 0.385941d0, 0.304609d0,&
0.250295d0, 0.211860d0, 0.130245d0, 0.0936901d0,&
0.0658322d0   /

Data sf10 / 0.999997d0, 0.999993d0, 0.999987d0, 0.999980d0,&
0.999972d0, 0.999922d0, 0.999847d0, 0.999692d0,&
0.999319d0, 0.998809d0, 0.998171d0, 0.997410d0,&
0.993256d0, 0.987574d0, 0.976775d0, 0.954373d0,&
0.928411d0, 0.900439d0, 0.871505d0, 0.757578d0,&
0.657798d0, 0.539634d0, 0.406564d0, 0.322302d0,&
0.265515d0, 0.225106d0, 0.138767d0, 0.0999073d0,&
0.072340d0  /

SAVE y2_p,as,bs,cs,ps

! CONSTRUCTION OF THE POTENTIAL
! --- The section below is the initial setup.

IF (R.EQ.0.D0) THEN

do i=1,ncn-1
prs(i) = prs(i) - de
prs(i) = prs(i)*4.556336d-6
enddo

U = ras(ncn)

C = CSIX/U**6 + CEIGHT/U**8 + CTEN/U**10
TAIL = AMP*(U**ALPHA)*DEXP(-BETA*U)
VCALC = - C - TAIL
prs(ncn) = vcalc

SLOPE = (6.0d0*CSIX/(U**7)) + (8.0d0*CEIGHT/(U**9)) &
+ (10.0d0*CTEN/(U**11))&
- (ALPHA/U - BETA)*AMP*(U**ALPHA)*DEXP(-BETA*U)
YP1=1.D40
YPN=SLOPE
CALL Cubic_SPLINE(RaS,PRS,NCN,YP1,YPN,Y2_p)
x1 = RaS(1)
kindd = 1
CALL Cubic_SPLINT(RaS,PrS,Y2_p,NCN,x1,S,kindd)

!  now I must intervene --JB
!  can't match a decaying exponential with positive coefficient
!  to a potential which is negative.  so, shift potential positive

cs = s
BS = -S/(PrS(1)-CS)
AS = (PrS(1)-CS)*DEXP(BS*RaS(1))
! THE NEXT THREE BRANCHES GIVE THE POTENTIAL DEPENDING ON R

ELSE IF ((R.GT.0.D0).AND.(R.LT.RaS(1))) THEN
!write(*,*) "code mark","r=",r,"cs=",cs,"bs=",bs,"as=",as,"TWOMU",TWOMU,"vxs=",TWOMU*AS*DEXP(-BS*R)+CS
vxssgp_unret = TWOMU*AS*DEXP(-BS*R)+CS
ELSE IF ((R.GE.RaS(1)).AND.(R.LE.RaS(NCN))) THEN
kindd = 0
CALL Cubic_SPLINT(RaS,PrS,Y2_p,NCN,R,POTS,kindd)
vxssgp_unret = TWOMU*POTS
ELSE
C = CSIX/R**6 + CEIGHT/R**8 + CTEN/R**10
TAIL = AMP*(R**ALPHA)*DEXP(-BETA*R)
vxssgp_unret = - C - TAIL
END IF

rmin = 7.9567848d0
IF(R.LE. rmin) THEN
vxssgp_unret = vxssgp_unret +   c0coef*datan((r-rmin)*(r-rmin)/(0.5d0*rmin))
END IF

RETURN
END
